<HTML>
<HEAD>
<TITLE></TITLE>
<META NAME="GENERATOR" Content="Microsoft Visual Studio">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<BODY>

<!-- Insert HTML here -->
<h2>Введение в коллективную разработку.</h2>
<h4>Репозиторий.</h4>
<p>Здесь я ничего писать не буду. А предложу прочитать <a 
href="https://web.archive.org/web/20140227231500/http://alexm.here.ru/cvs-ru/article.html">вот 
эту статью</a>. Лучше, чем там я не смогу сказать. Эта статья может убедить 
любого программиста в том, что ему нужен репозиторий, даже если этот программист 
час назад не знал этого слова. </p>
<h4>Софт.</h4>
<p>Итак, Вы прочитали статью (не прочитали? быстро читать! я не шучу) и захотели 
использовать репозиторий в своей повседневной работе. Но пока не знаете, с чего 
начать. А начнем мы с выкачивания и установки кучи софта. </p>
<p>Примечание: все программы в этой таблице - бесплатны и распространяются с 
исходными кодами. Это принипиальная позиция. 
<table border=1>
  <tr>
    <td>Название</td>
    <td>Где качать<br>(сколько весит)</td>
    <td>Краткое описание</td></tr>
  <tr>
    <td>WinCVS </td>
    <td><a 
      href="https://web.archive.org/web/20140227231500/http://www.wincvs.org/">http://www.wincvs.org/</a><br>(ок. 
      4 мегабайт) </td>
    <td>Это клиентская часть CVS. Необходима каждому "коллективному" 
      разработчику, работающему под платформой Win32. </td></tr>
  <tr>
    <td>GComp последней версии </td>
    <td><a 
      href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/download.html">http://1c.alterplast.ru/download.html</a><br>(менее 
      мегабайта) </td>
    <td>Утилита, позволяющая конвертировать файл 1cv7.md в набор текстовых 
      файлов и обратно. Необходима каждому "коллективному" разработчику 
      конфигураций 1С. </td></tr>
  <tr>
    <td>KDiff3 </td>
    <td><a 
      href="https://web.archive.org/web/20140227231500/http://kdiff3.sourceforge.net/">http://kdiff3.sourceforge.net/</a><br>(2 
      с небольшим мегабайта) </td>
    <td>Очень функциональная сравнивалка файлов и каталогов. Русифицирована. 
      Интегрируется с WinCVS. Можно, конечно, пользоваться внутренней WinCVS'вой 
      диффалкой, но зачем, когда есть такая красота?<br><b>Примечание:</b> для 
      интеграции kdiff3 с WinCVS установите сначала WinCVS, и только потом - 
      kdiff3. </td></tr>
  <tr>
    <td>Python </td>
    <td><a 
      href="https://web.archive.org/web/20140227231500/http://www.python.org/">http://www.python.org/</a><br>(10 
      мегабайт) </td>
    <td>Позволяет запускать всякие скрипты, которые существенно расширяют 
      функционал WinCVS. Для самых первых экспериментов Питон тоже особо не 
      нужен, но вещь в хозяйстве очень и очень полезная.<br>Можно также 
      воспользоваться <a 
      href="https://web.archive.org/web/20140227231500/http://www.activeware.com/Products/ActivePython/">ActivePython</a>, 
      но он весит еще больше :)<br>По состоянию на февраль 2007 года я не 
      рекомендую пользоваться Питоном из ветки 2.5. </td></tr></table></p>
<p>Самой сложной программой в этом пакете является WinCVS. Поэтому сразу даю 
ссылки на развернутую документацию к CVS вообще и к WinCVS в частности. </p>
<ul>
  <li>Первоисточник знаний про CVS находится на <a 
  href="https://web.archive.org/web/20140227231500/http://www.cvshome.org/">http://www.cvshome.org/</a>.<br></li>
  <li>Перевод документации к CVS на русский и многое другое на великом и могучем 
  можно найти на <a 
  href="https://web.archive.org/web/20140227231500/http://alexm.here.ru/cvs-ru/">страничке 
  Алексея Махоткина</a>.<br></li>
  <li>Документация к WinCVS на русском языке есть вот тут: <a 
  href="https://web.archive.org/web/20140227231500/http://cbuilder.by.ru/Files/CVS/WinCvsGuide.rar">http://cbuilder.by.ru/Files/CVS/WinCvsGuide.rar</a> 
  </li>
  <li>Так же есть неплохое руководство с картинками по адресу <a 
  href="https://web.archive.org/web/20140227231500/http://free.metabuilder.ru/doc/MBmanual3.htm">http://free.metabuilder.ru/doc/MBmanual3.htm</a> 
  </li></ul>
<p></p>
<h4>Первые эксперименты</h4>
<h4>cvs init;</h4>
<p>Для начала мы создадим и проинициализируем репозиторий. Для этого создадим 
пустую папочку, где-нибудь поближе к корню. Пусть это будет D:\repo.<br>Теперь 
запустим WinCVS. При первом запуске он спросит, где находится репозиторий. 
Укажем ему на нашу папочку (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoinit-1.jpg">см. 
картинку</a>).<br>Теперь решим небольшую проблемку. Наш будущий репозиторий - на 
диске D, а в списке дисков, доступных для WinCVS - только C (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoinit-2.jpg">см. 
картинку</a>). Обратим внимание на рисунок двух папочек чуть правее списка. Жмем 
туда.<br>Наш репозиторий все еще не проинициализирован. Идем в меню "Remote" - 
"Create a new repository". Выскакивает таблетка с несколькими закладками (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoinit-3.jpg">см. 
рисунок</a>). Читаем то, что написано на первой закладке, еще раз проверяем, что 
на второй закладке указан путь D:\repo, и смело жмем OK. Тут WinCVS задаст еще 
один вопрос: про домашнюю папку. Смысла этого вопроса я не знаю, но рекомендую 
указать еще одну пустую папку (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoinit-4.jpg">см. 
рисунок</a>).<br>Все, репозиторий готов к работе (это можно понять по наличию 
папки D:\repo\cvsroot).<br></p>
<h4>cvs import;</h4>
<p>Репозиторий есть, однако в нем ничего нет. Нужно это как-то 
исправить.<br>Создадим еще одну папку, где будут находится наши локальные файлы 
- d:\project.<br>
<table border=1>
  <tr>
    <td><i>Тут необходимо небольшое отступление. У нас сейчас - репозиторий 
      находится на той же машине, где работаем и мы сами. Но в большинстве 
      случаев репозиторий будет лежать где-то в сети, удаленно. При этом наша 
      непосредственная работа как разработчиков будет происходить с локальной 
      копией этих файлов на нашей машине. CVS же как раз занимается 
      синхронизацией этих двух копий (при чем обмен данными идет в обе стороны). 
      Так вот, если я говорю просто "репозиторий", или "центральный 
      репозиторий", или "удаленный репозиторий" - это репозиторий главный, 
      удаленный (даже если он находится на нашей машине). Если же я говорю 
      "локальный репозиторий" или "локальная копия" - то это те файлы, с 
      которыми мы непосредственно работаем.</i> </td></tr></table>В папке 
d:\project создадим файлик readme.txt в котором напишем "Здесь будет описание 
нашего первого распределенного проекта.". Теперь идем в окно WinCVS, в дереве 
каталогов находим папку d:\project, щелкаем правой мышкой, выбираем пункт Import 
module (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-0.jpg">см. 
картинку</a>). </p>
<p>WinCVS проанализирует все файлы, которые есть у нас в папке, и выскажет свои 
предположения по поводу того, какие файлы текстовые, а какие - бинарные (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-1.jpg">см. 
картинку</a>). Надо отметить, что предполагает он из рук вон плохо. И приходится 
практически для каждого расширения указывать тип вручную. Так и на этот раз - 
скажем, что readme.txt - текстовый, а не бинарный файл (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-2.jpg">см. 
картинку</a>). </p>
<p>На следующем окошке (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-3.jpg">см. 
картинку</a>) остановимся чуть подробнее. В поле "Repository path" можно указать 
имя нашего будущего "проекта" так, как он будет хранится в центральном 
репозитории. По умолчанию берется имя локальной папки, и лично мне оно не очень 
нравится. Именно сейчас время придумать имя своему проекту (или "модулю", в 
терминологии CVS), и я не хочу ошибится. Пусть это будет "Experiments". Именно 
это туда и пишем.<br>Второе важное поле - самое больше поле для ввода, 
озаглавленное "Enter the log message". Журнальная запись - это наш комментарий 
для самих себя и для других разработчиков. Создание хороших журнальных записей - 
это целое исскуство. Пока же просто напишем туда "Начали эксперименты с CVS". 
Остальные поля (в том числе, на других закладках) - не трогаем и оставляем как 
есть. Жмем OK. В нижнем окне "Output" (где показаны команды CVS и их результат) 
должно быть написано примерно следующее: </p>
<hr>
<pre>Filtering 'D:\project\'...
cvs -q import -I ! -I CVS -m "Начали эксперименты с CVS" 
Experiments avendor arelease (in directory D:\project\)
N Experiments/readme.txt

No conflicts created by this import


***** CVS exited normally with code 0 *****
</pre>
<hr>

<p></p>
<p>Теперь заглянем в папку d:\repo и найдем там папку Experiments с файлом 
readme.txt,v внутри. Нашли? Отлично. Это и есть наш readme.txt в центральном 
репозитории. </p>
<h4>cvs checkout;</h4>
<p>Папку project теперь можно удалить - вся информация есть в центральном 
репозитории. Создадим локальную копию (папка project для этой цели не годится, 
сейчас вы поймете, почему). Для создания локального репозитория щелкнем правой 
мышкой на диске D: в дереве WinCVS и выберем пункт "Checkout module" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-4.jpg">см. 
картинку</a>). В поле "Module name" укажем "Experiments" и нажмем ОК (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-5.jpg">см. 
картинку</a>). В Output увидим примерно следующее: </p>
<hr>
<pre>cvs -q checkout -P Experiments (in directory D:\)
U Experiments/readme.txt

***** CVS exited normally with code 0 *****
</pre>
<hr>
Заглянем в каталог D:\Experiments - и кроме нашего файла readme.txt мы увидим 
папку CVS, где WinCVS хранит свои служебные данные (например информацию о 
способе доступа к удаленному репозиторию для конкретного модуля). 
<p></p>
<p>Теперь сымитируем второго разработчика. Еще раз жмем "Checkout module" на 
корне диска D:\, но в отличие от предыдущего раза - ставим галочку "Check out 
into directory" и заполняем соответствующее поле значением "Experiments_2" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoimport-6.jpg">см. 
картинку</a>). </p>
<h4>cvs commit;</h4>
<p>Итак, первый разработчик захотел добавить в свой D:\Experiments\readme.txt 
еще пару слов, и написал там второй строчкой "(c) 2004 Вася Пупкин."<br>После 
того, как файл был сохранен, в окне WinCVS он стал красного цвета (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repocommit-0.jpg">см. 
рисунок</a>). Самое время сохранить изменения в центральном репозитории. Щелкаем 
по красному файлику правой мышкой, выбираем пункт "Commit selection" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repocommit-1.jpg">см. 
картинку</a>), в журнальную запись вставляем "Добавлены копирайты", жмем 
ОК.<br>Если все нормально, то в окне "Output" мы будем наблюдать примерно 
следующее: </p>
<hr>
<pre>cvs -q commit -m "Добавлены копирайты" readme.txt (in directory
D:\Experiments\)
Checking in readme.txt;
/usr/cvsroot/Experiments/readme.txt,v  &lt;--  readme.txt
new revision: 1.2; previous revision: 1.1
done

***** CVS exited normally with code 0 *****
</pre>
<hr>
Обратим внимание на строчку "new revision: 1.2;", а так же на колонку "Rev." в 
WinCVS, где так же увидим номер ревизии - 1.2. 
<p></p>
<h4>cvs update;</h4>
<p>Теперь второй разработчик захотел обновить свои локальные файлы. Для этого он 
щелкает на папке с ними (то есть, D:\Experiments_2) правой мышкой и выбирает 
пункт "Update selection" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoupdate-0.jpg">см. 
картинку</a>). В окне "Output" мы увидим примерно следующее: </p>
<hr>
<pre>cvs -q update -P (in directory D:\Experiments_2\)
U readme.txt

***** CVS exited normally with code 0 *****
</pre>
<hr>
Строчка "U readme.txt" говорит нам о том, что файл readme.txt изменился. И мы 
видим, что и у второго разработчика теперь ревизия 1.2. 
<p></p>
<h4>cvs add;</h4>
<p>Теперь пришло время добавить в проект что-то более существенное, чем 
readme.txt. Вася Пупкин хочет создать скрипт сборки дистрибутива. Он создает 
новый файл makedistr.bat (и мы вслед за ним), и пишет туда примерно следующее: 
<table border=1>
  <tr>
    <td><pre>pkzip -a experiments.zip *.txt</pre></td></tr></table>В окошке 
WinCVS мы видим этот файл со знаком вопроса (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoadd-0.jpg">см. 
рисунок</a>) и комментарием в колонке State - Unknown. Репозиторию нужно сказать 
о том, что у нас есть новый файл. Это просто - жмем на нем правой мышкой, 
выбираем "Add selection" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/repoadd-1.jpg">см. 
картинку</a>). Обратим внимание, что нам сказал WinCVS в окне Output: </p>
<hr>
<pre>cvs -q add makedistr.bat (in directory D:\Experiments\)
cvs add: use 'cvs commit' to add this file permanently

***** CVS exited normally with code 0 *****
</pre>
<hr>
Итак, репозиторий уже знает, что мы добавили новый файл, но самого файла еще не 
получил (это можно увидеть, посмотрев в папку d:\repo - там пока еще нет файла 
makedistr.bat,v). Содержимое файла репозиторий получит по команде "commit", 
которую мы тут же и сделаем (эту операцию мы уже проделывали один раз - 
справитесь без моих подсказок). 
<p></p>
<h4>cvs remove;</h4>
<p>Вася Пупкин немного подумал, и решил, что со скриптом сборки дистрибутива он 
явно поторопился. И файл makedistr.bat надо бы удалить. Не проблем, выделяем 
файл, идем в контекстное меню "Modify" - "Remove" (<a 
href="https://web.archive.org/web/20140227231500/http://1c.alterplast.ru/gcomp/reporemove-0.jpg">см. 
рисунок</a>). (В контекстном меню этой операции по умолчанию нет, и пожалуй, это 
правильно. Однако контекстное меню в WinCVS легко настраивается.) В ответ на 
Remove получаем в Output: </p>
<hr>
<pre>'makedistr.bat' has been moved successfully to the recycle bin...
cvs -q remove makedistr.bat (in directory D:\Experiments\)
cvs remove: use 'cvs commit' to remove this file permanently

***** CVS exited normally with code 0 *****
</pre>
<hr>
Мы видим, что файл был удален из локального репозитория, а центральному 
репозиторию так же была послана команда на удаление. Однако окончательное 
удаление, как и добавление файла, произойдет по команде "commit". 
<p></p>
<p>Отдельно стоит отметить, что в CVS невозможно удалить каталог. Но можно в CVS 
Preferences на закладке Global установить галочку "Prune empty directories", и 
тогда папки, из которых были удалены все файлы, будут удаляться при каждом cvs 
update в вашем локальном репозитории. </p>
<h4>Итоги.</h4>Вы немного поигрались с новой игрушкой, и вроде даже немного 
освоились. Пора загружать репозиторий реальной работой. И здесь - первая 
незадача. Вся конфигурация 1С хранится в одном бинарном файле, а CVS, что 
характерно, в первую очередь ориентируется на работу с текстовыми файлами. 
<p></p>
<p>На помощь приходит gcomp - утилита, позволяющая разобрать MD в набор 
каталогов и текстовых файликов, а так же умеющая совершать и обратную 
операцию.</p>

</BODY>
</HTML>