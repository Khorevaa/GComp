<HTML>
<HEAD>
<TITLE></TITLE>
<META NAME="GENERATOR" Content="Microsoft Visual Studio">
<META HTTP-EQUIV="Content-Type" content="text/html; charset=UTF-8">
</HEAD>
<BODY>

<!-- Insert HTML here -->
<h2>Коллективная разработка конфигураций 1С.</h2>
<h4>Небольшой FAQ</h4>
<ol>
  <li>
  <p>В версии GComp 1.00 потоки Container.Contents нужно выкладывать в 
  репозиторий как бинарные файлы. Проблема в том, что у них последним символом - 
  0x0A. Для текстовых файлов cvs при цикле commit/update добавляет к одиночным 
  0x0A символ 0x0D - сказываются различия обозначения конца строки между Windows 
  и Unix. А получившаяся в результате сборки конфигурация оказывается 
  неработоспособной.</p>
  <hr>
  </li>
  <li>
  <p>Если попробовать собрать конфигурацию в каталоге, который входит в состав 
  сборки - gcomp вполне предсказуемо повиснет, поскольку будет стараться 
  засунуть формируемый compound сам в себя.<br>Тем, кто не понял сути 
  вышесказанного - попробуйте помедитировать над следующей командой (точка в 
  конце - значимый элемент команды):<br></p><pre>gcomp -c -D .</pre>
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Как CVS-у один раз и навсегда рассказать, какие типы файлов 
  GComp являются текстовыми, а какие - бинарными?<br><b>(Ответ)</b> в папке 
  CVSROOT найти файл cvswrappers. Если нет - создать. Если туда добавить 
  следующие строки </p><pre>__Picture.* -k 'b'
Gallery -k 'b'
*.mxl -k 'b'
Page.* -k 'b'
GUIDData -k 'b'
TagStream -k 'b'
</pre>то файлы по указанным маскам будут считаться двоичными. 
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Ну сделал, как сказано в предыдущем пункте, а при импорте 
  WinCVS все равно предлагает раздать файлам какие-то свои типы, игнорируя 
  настройки в cvswrappers.<br><b>(Ответ)</b> WinCVS игнорирует содержимое файла 
  cvswrappers. И это не баг, а документированная фича :-/ Приходится либо каждый 
  раз ручками указывать типы файлов, либо импортировать другими клиентами (<a 
  href="https://web.archive.org/web/20140228003748/http://www.tortoisecvs.org/">TortoiseCVS</a> 
  понимает cvswrappers).<br>При добавлении новых файлов через WinCVS та же 
  история: как скажешь (add или add binary) - так и загрузится. WinCVS любит 
  ругаться, мол совсем это не текстовый файл, но мы-то лучше знаем, правда? :)) 
  </p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Пытаюсь собрать gcomp из исходников - а оно ругается, 
  говорит нету какого-то bison. Что это за бизон, и где он 
  пасется?<br><b>(Ответ)</b> <a 
  href="https://web.archive.org/web/20140228003748/http://gnu.chg.ru/software/bison/bison.html">Bison</a> 
  - это такой специализированный инструмент для написания парсеров и 
  синтаксических анализаторов. GComp его использует для разбора потока Main 
  Metadata Stream. Разработчики GComp используют bison из состава пакета <a 
  href="https://web.archive.org/web/20140228003748/http://cygwin.com/">CygWin</a>. 
  Однако, если не залезать в разбор MMS - можно обойтись и без бизона. 
  Достаточно удалить из состава проекта все файлы с расширением .y, поскольку 
  одноименные .cpp (результат работы бизона) так же входят в поставку. </p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Можно ли с помощью gcomp уменьшить размер внешнего 
  отчета?<br><b>(Ответ)</b> Можно. Если написать </p><pre>gcomp -d -F СуперКрутаяОбработка.ert
gcomp -c -F СуперКрутаяОбработка.ert --no-empty-mxl --truncate-mms
</pre>то размерчик файла станет много меньше, за счет того, что выкидываются 
  пустые моксели и обрезается Main Metadata Stream.<br>Нельзя только делать 
  --truncate-mms на обработках, где есть типизированные поля (документы, 
  справочники, счета, перечисления).<br>Еще на внешних обработках нельзя делать 
  --no-profiles - они после этого перестают работать. 
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Можно ли с помощью gcomp уменьшить размер 
  конфигурации?<br><b>(Ответ)</b> Можно. Если написать </p><pre>gcomp -d --no-empty-mxl --no-profiles
gcomp -c
</pre>то размерчик конфигурации станет немного меньше.<br>Делать 
  --truncate-mms на файлах конфигурации не только не надо, но и чревато сильными 
  неприятностями. 
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Запускаю декомпиляцию следующей командой </p><pre>gcomp -d -D "c:\program files\1cv77\MyConfig\"</pre>а gcomp отказывается 
  работать. Что я делаю не так?<br><b>(Ответ)</b> Чтобы можно было указать имя 
  файла, содержащее в себе символ "двойная кавычка", было придумано заменять 
  этот символ на escape последовательность \"<br>Соответственно, указанный в 
  вопросе путь распознается не так, как это может показаться с первого взгляда, 
  а распознается вовсе даже совсем по другому. Вариантов выхода из сложившейся 
  ситуации - три. 
  <ul>
    <li>Избавиться от кавычек: <pre>gcomp -d -D c:\progra~1\1cv77\MyConfig\</pre></li>
    <li>Избавиться от заключительного слэша: <pre>gcomp -d -D "c:\program files\1cv77\MyConfig"</pre></li>
    <li>Изобразить последний слэш соответствующей escape последовательностью: <pre>gcomp -d -D "c:\program files\1cv77\MyConfig\\"</pre></li></ul>
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> У меня есть две конфигурации: одна оригинальная, вторая 
  перекомпилированная gcomp'ом.<br>Я запускаю 1С-вое объединение конфигураций, и 
  1С мне говорит, что конфигурации идентичны (или наоборот, показывает 
  различия).<br>Насколько можно доверять этой информации? <br><b>(Ответ)</b> В 
  большинстве случаев - можно. Однако бывает, что объединение конфигураций врет. 
  </p>
  <ol>
    <li>Если изменить галерею картинок - 1С при объединении этого не заметит и 
    скажет, что конфигурации идентичны. </li>
    <li>Если программные модули перепаковать не 1С-вым zlibeng.dll, а сторонним 
    алгоритмом (как это делает например <a 
    href="https://web.archive.org/web/20140228003748/http://www.consult.legion.ru/alf/inserter.shtml">Inserter 
    от АЛьФа</a>) то при объединении 1С будет уверена, что модули изменились, 
    хотя при попытке сравнить такие "изменившиеся" модули сама же скажет, что 
    файлы не отличаются. </li>
    <li>Форматы экранных форм, интерфейсов и прав пользователей несут 
    определенное количество излишней информации, которая никаким образом на 
    функциональность 1С не влияет. GComp по умолчанию такую информацию 
    "оптимизирует", что и становится заметным при сравнении. Особенно сильно 
    грешат этим экранные формы. Чтобы смягчить этот эффект - используйте опцию 
    --no-dialogs-default, чтобы исключить совсем - --no-parse-dialogs. </li></ol>
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Мне кажется, что я нашел ошибку в gcomp. Кому и как об этом 
  сообщить?<br><b>(Ответ)</b> Ошибки в gcomp бывают двух типов. </p>
  <ol>
    <li>gcomp вообще не работает (аварийно завершается или выдает какую-то 
    ошибку).<br>В этой ситуации сначала попробуйте воспроизвести ошибку.<br>Если 
    ошибка воспроизводится - попробуйте локализовать проблему (не работает при 
    определенном наборе параметров, или не работает с определенной 
    конфигурацией, или не работет на определенном компьютере). <br>Когда ошибка 
    локализована - сходите на <a 
    href="https://web.archive.org/web/20140228003748/http://cvs.alterplast.ru/bugs/">http://cvs.alterplast.ru/bugs/</a>, 
    и на <a 
    href="https://web.archive.org/web/20140228003748/http://itland.ru/forum/index.php?showforum=36">Форум</a> 
    возможно, об этой ошибке уже известно. Если же не известно - Багзилла или 
    форум - лучшее место, куда можно поведать миру о вашем открытии. </li>
    <li>gcomp работает, но не так, как ожидается (портит/изменяет 
    конфигурацию).<br>В этой ситуации, в дополнение к предыдущим пунктам, 
    необходимо убедиться, что в процессе ваших экспериментов конфигурацию 
    изменял только gcomp. Конфигурация могла измениться и в процессе прогонки 
    через CVS (см. первый вопрос этого FAQ), и в результате работы третьих 
    программ (например, Inserter, см. предыдущий вопрос). </li></ol>
  <p></p>
  <hr>
  </li>
  <li>
  <p><b>(Вопрос)</b> Работает ли gcomp на конфигурациях, закрытых паролем? На 
  базовых конфигурациях? <br><b>(Ответ)</b> Нет. И скорее всего - не будет. 
  Лично мое отношение к этому такое: gcomp - это ежедневный инструмент 
  разработчика. Разрабатывать базовую конфигурацию - вообще невозможно, она 
  сразу перестает быть базовой. А ставить пароль нужно (если нужно) - только 
  перед отправкой к потребителю. Ежедневная работа с запароленной конфигурацией 
  довольно сильно утомляет.<br>В крайнем случае, для особо страждущих, есть 
  ActiveMD от Павла Бычковяка, которая умеет работать и с базовыми 
  конфигурациями, и с закрытыми паролем. </p></li></ol>

</BODY>
</HTML>